!function(a){"use strict";a.module("template-prefetch",["ui.router"]).provider("TemplatePrefetch",[function(){var b=[],c=function(b,c){var d={name:b};return c&&!a.equals({},c)&&(d.stateParams=c),d},d=function(a,b){var c=[];return b&&c.push(b),{from:a,to:c,"new":!0}},e=function(a,b){var d=a;return"string"==typeof a&&(d=c(a,b)),d},f=function(c){for(var d=0;d<b.length;d++){var e=b[d];if(a.equals(e.from,c))return e}},g=function(b,c){for(var d=0;d<c.length;d++){var e=c[d];if(a.equals(e,b))return e}},h=function(a,b){var c=e(a,b),g=f(c)||d(c);return{to:i(g)}},i=function(a){return function(c,d){var f=e(c,d);return g(f,a.to)||a.to.push(f),a["new"]&&(delete a["new"],b.push(a)),{to:i(a),from:h}}};this.$get=["$rootScope","$state","$stateParams","$templateCache","$http","$log",function(a,b,d,e,g,h){function i(a){for(var b,c=/ng-include=('"|"')(.+?)('"|"')/g;b=c.exec(a);){var d=b[2];k(d)}}h.debug("TemplatePrefetch: Instantiated");var j=function(a,d){h.debug("TemplatePrefetch: Called with fromState "+a+", fromParams "+JSON.stringify(d));var e=f(c(a,d));if(!e)return void h.debug("No edge found for fromState "+a);for(var g=0;g<e.to.length;g++){var i,j=e.to[g],l=j.name,n=b.get(l);if(h.debug("TemplatePrefetch: Determining templates for toState "+l+", toParams: "+JSON.stringify(j.stateParams)),!n.templateUrl&&n.views){h.debug("TemplatePrefetch: No templateUrl for state "+l+", checking views...");for(var o in n.views){var p=n.views[o];p.templateUrl&&(i=m(p,d,j.stateParams),k(i))}}else i=m(n,d,j.stateParams),k(i)}},k=function(a){e.get(a)?h.debug("TemplatePrefetch: Template already cached - "+a):(h.debug("TemplatePrefetch: Fetching template - "+a),g.get(a).success(l(a)))},l=function(a){return function(b){i(b),e.put(a,b)}},m=function(a,b,c){var d=a.templateUrl;return"function"==typeof d?d(c||{}):d};return""!==b.current.name&&j(b.current.name,d),a.$on("$stateChangeSuccess",function(a,b,c){j(b.name,c)}),{}}],this.from=h,this.getRoutesFor=function(a,b){var c=e(a,b),d=f(c);return d?d.to:[]}}]).run(function(a){})}(angular);